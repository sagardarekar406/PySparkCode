from pyspark.sql import SparkSession
from pyspark.sql.functions import (
    col, lower, when, count, avg, current_date, trim
)

# Jira: DATA-101 - Initialize Spark session for user data pipeline
spark = SparkSession.builder \
    .appName("UserDataProcessingPipeline") \
    .getOrCreate()


# Jira: DATA-102 - Read user data from source CSV
users_df = spark.read.csv(
    "/data/input/users.csv",
    header=True,
    inferSchema=True
)
